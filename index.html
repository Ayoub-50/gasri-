<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NovaMind AI â€” Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ</title>
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700;900&family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg-deep: #040810;
    --bg-card: rgba(10, 18, 35, 0.85);
    --accent-cyan: #00f5ff;
    --accent-violet: #7c3aed;
    --accent-pink: #ec4899;
    --accent-gold: #f59e0b;
    --text-primary: #e8f0fe;
    --text-secondary: #8899bb;
    --border: rgba(0, 245, 255, 0.15);
    --glow: 0 0 30px rgba(0, 245, 255, 0.25);
    --user-bubble: linear-gradient(135deg, #7c3aed, #4f46e5);
    --ai-bubble: rgba(0, 245, 255, 0.06);
    --radius: 20px;
    --input-bg: rgba(5, 12, 28, 0.9);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Cairo', 'Tajawal', sans-serif;
    background: var(--bg-deep);
    color: var(--text-primary);
    height: 100vh;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ANIMATED BACKGROUND â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .bg-canvas {
    position: fixed;
    inset: 0;
    z-index: 0;
    overflow: hidden;
  }

  .bg-canvas::before {
    content: '';
    position: absolute;
    inset: 0;
    background:
      radial-gradient(ellipse 80% 60% at 20% 10%, rgba(124, 58, 237, 0.25) 0%, transparent 60%),
      radial-gradient(ellipse 60% 80% at 80% 90%, rgba(0, 245, 255, 0.15) 0%, transparent 60%),
      radial-gradient(ellipse 50% 50% at 50% 50%, rgba(236, 72, 153, 0.08) 0%, transparent 70%);
    animation: nebula 12s ease-in-out infinite alternate;
  }

  @keyframes nebula {
    0%   { filter: hue-rotate(0deg) brightness(1); }
    50%  { filter: hue-rotate(30deg) brightness(1.1); }
    100% { filter: hue-rotate(-20deg) brightness(0.95); }
  }

  .grid-overlay {
    position: absolute;
    inset: 0;
    background-image:
      linear-gradient(rgba(0, 245, 255, 0.04) 1px, transparent 1px),
      linear-gradient(90deg, rgba(0, 245, 255, 0.04) 1px, transparent 1px);
    background-size: 60px 60px;
    animation: gridDrift 20s linear infinite;
  }

  @keyframes gridDrift {
    0%   { transform: translateY(0); }
    100% { transform: translateY(60px); }
  }

  /* Floating orbs */
  .orb {
    position: absolute;
    border-radius: 50%;
    filter: blur(60px);
    opacity: 0.35;
    animation: orbFloat linear infinite;
  }
  .orb-1 { width: 350px; height: 350px; background: #7c3aed; top: -100px; left: 10%; animation-duration: 18s; }
  .orb-2 { width: 250px; height: 250px; background: #00f5ff; bottom: 5%; right: 5%; animation-duration: 14s; animation-delay: -5s; }
  .orb-3 { width: 200px; height: 200px; background: #ec4899; top: 40%; left: 60%; animation-duration: 22s; animation-delay: -9s; }
  .orb-4 { width: 180px; height: 180px; background: #f59e0b; bottom: 30%; left: 5%; animation-duration: 16s; animation-delay: -3s; }

  @keyframes orbFloat {
    0%, 100% { transform: translateY(0) scale(1); }
    33%       { transform: translateY(-40px) scale(1.05); }
    66%       { transform: translateY(25px) scale(0.97); }
  }

  /* Shooting stars */
  .stars-container {
    position: absolute;
    inset: 0;
    overflow: hidden;
  }

  .star {
    position: absolute;
    width: 2px;
    height: 2px;
    background: #fff;
    border-radius: 50%;
    animation: twinkle var(--dur, 3s) ease-in-out infinite;
    animation-delay: var(--delay, 0s);
  }

  @keyframes twinkle {
    0%, 100% { opacity: 0.1; transform: scale(1); }
    50%       { opacity: 1; transform: scale(1.5); }
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LAYOUT â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .app-wrapper {
    position: relative;
    z-index: 10;
    display: flex;
    flex-direction: column;
    height: 100vh;
    max-width: 900px;
    margin: 0 auto;
    width: 100%;
    padding: 0 16px;
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• HEADER â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 18px 0 14px;
    border-bottom: 1px solid var(--border);
    flex-shrink: 0;
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .logo-icon {
    width: 44px;
    height: 44px;
    background: linear-gradient(135deg, var(--accent-violet), var(--accent-cyan));
    border-radius: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 22px;
    box-shadow: 0 0 20px rgba(124, 58, 237, 0.5);
    animation: logoGlow 3s ease-in-out infinite alternate;
    position: relative;
    overflow: hidden;
  }

  .logo-icon::after {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, transparent 40%, rgba(255,255,255,0.15));
  }

  @keyframes logoGlow {
    from { box-shadow: 0 0 20px rgba(124, 58, 237, 0.5); }
    to   { box-shadow: 0 0 40px rgba(0, 245, 255, 0.6); }
  }

  .logo-text h1 {
    font-size: 22px;
    font-weight: 900;
    background: linear-gradient(90deg, var(--accent-cyan), var(--accent-violet), var(--accent-pink));
    background-size: 200%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    animation: gradientShift 4s ease infinite;
    letter-spacing: -0.5px;
  }

  @keyframes gradientShift {
    0%, 100% { background-position: 0% }
    50%       { background-position: 100% }
  }

  .logo-text span {
    font-size: 11px;
    color: var(--text-secondary);
    font-weight: 300;
    letter-spacing: 2px;
    text-transform: uppercase;
  }

  .status-badge {
    display: flex;
    align-items: center;
    gap: 7px;
    padding: 7px 14px;
    border-radius: 30px;
    background: rgba(0, 245, 255, 0.06);
    border: 1px solid rgba(0, 245, 255, 0.2);
    font-size: 12px;
    color: var(--accent-cyan);
    font-weight: 600;
  }

  .status-dot {
    width: 8px;
    height: 8px;
    background: #22c55e;
    border-radius: 50%;
    animation: pulse 2s ease-in-out infinite;
    box-shadow: 0 0 8px #22c55e;
  }

  @keyframes pulse {
    0%, 100% { transform: scale(1); opacity: 1; }
    50%       { transform: scale(1.4); opacity: 0.7; }
  }

  .model-selector {
    padding: 7px 14px;
    border-radius: 30px;
    background: rgba(124, 58, 237, 0.12);
    border: 1px solid rgba(124, 58, 237, 0.35);
    color: #a78bfa;
    font-size: 12px;
    font-weight: 600;
    font-family: 'Cairo', sans-serif;
    cursor: pointer;
    outline: none;
    appearance: none;
    transition: all 0.3s;
  }

  .model-selector:hover { background: rgba(124, 58, 237, 0.22); }
  .model-selector option { background: #0a1223; color: #e8f0fe; }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MESSAGES â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .messages-area {
    flex: 1;
    overflow-y: auto;
    padding: 24px 0 16px;
    display: flex;
    flex-direction: column;
    gap: 18px;
    scroll-behavior: smooth;
  }

  .messages-area::-webkit-scrollbar { width: 5px; }
  .messages-area::-webkit-scrollbar-track { background: transparent; }
  .messages-area::-webkit-scrollbar-thumb { background: rgba(124, 58, 237, 0.4); border-radius: 10px; }

  /* Welcome screen */
  .welcome-screen {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    flex: 1;
    gap: 28px;
    padding: 40px 0;
    text-align: center;
    animation: fadeInUp 0.8s ease both;
  }

  @keyframes fadeInUp {
    from { opacity: 0; transform: translateY(30px); }
    to   { opacity: 1; transform: translateY(0); }
  }

  .welcome-icon {
    width: 90px;
    height: 90px;
    background: linear-gradient(135deg, var(--accent-violet), var(--accent-cyan));
    border-radius: 28px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 44px;
    box-shadow: 0 0 60px rgba(0, 245, 255, 0.3), 0 0 100px rgba(124, 58, 237, 0.2);
    animation: welcomeFloat 4s ease-in-out infinite;
  }

  @keyframes welcomeFloat {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    25%       { transform: translateY(-12px) rotate(2deg); }
    75%       { transform: translateY(6px) rotate(-1deg); }
  }

  .welcome-title {
    font-size: 36px;
    font-weight: 900;
    background: linear-gradient(90deg, var(--accent-cyan), var(--accent-violet));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1.2;
  }

  .welcome-sub {
    font-size: 16px;
    color: var(--text-secondary);
    max-width: 420px;
    line-height: 1.8;
  }

  .suggestion-chips {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    justify-content: center;
    max-width: 600px;
  }

  .chip {
    padding: 10px 18px;
    border-radius: 50px;
    background: var(--ai-bubble);
    border: 1px solid var(--border);
    color: var(--text-secondary);
    font-size: 13px;
    cursor: pointer;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    font-family: 'Cairo', sans-serif;
    white-space: nowrap;
  }

  .chip:hover {
    background: rgba(0, 245, 255, 0.1);
    border-color: rgba(0, 245, 255, 0.4);
    color: var(--accent-cyan);
    transform: translateY(-2px) scale(1.03);
    box-shadow: 0 8px 20px rgba(0, 245, 255, 0.15);
  }

  /* Message Bubbles */
  .message {
    display: flex;
    gap: 14px;
    align-items: flex-start;
    animation: messageIn 0.45s cubic-bezier(0.34, 1.56, 0.64, 1) both;
  }

  @keyframes messageIn {
    from { opacity: 0; transform: translateY(20px) scale(0.96); }
    to   { opacity: 1; transform: translateY(0) scale(1); }
  }

  .message.user { flex-direction: row-reverse; }

  .avatar {
    width: 38px;
    height: 38px;
    border-radius: 50%;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 17px;
    font-weight: 700;
  }

  .avatar.ai {
    background: linear-gradient(135deg, #00d4ff, #7c3aed);
    box-shadow: 0 0 15px rgba(0, 245, 255, 0.35);
  }

  .avatar.user {
    background: linear-gradient(135deg, #ec4899, #7c3aed);
    box-shadow: 0 0 15px rgba(236, 72, 153, 0.35);
  }

  .bubble {
    max-width: 72%;
    padding: 14px 18px;
    border-radius: var(--radius);
    line-height: 1.75;
    font-size: 14.5px;
    position: relative;
  }

  .bubble.ai {
    background: var(--ai-bubble);
    border: 1px solid var(--border);
    border-top-right-radius: 6px;
    backdrop-filter: blur(12px);
  }

  .bubble.user {
    background: var(--user-bubble);
    border-top-left-radius: 6px;
    box-shadow: 0 8px 30px rgba(124, 58, 237, 0.3);
  }

  .bubble-name {
    font-size: 11px;
    font-weight: 700;
    letter-spacing: 1px;
    text-transform: uppercase;
    margin-bottom: 6px;
    opacity: 0.6;
  }

  .bubble.ai .bubble-name { color: var(--accent-cyan); }
  .bubble.user .bubble-name { color: rgba(255,255,255,0.7); }

  .bubble-text {
    white-space: pre-wrap;
    word-break: break-word;
  }

  /* Typing indicator */
  .typing-indicator {
    display: flex;
    gap: 14px;
    align-items: flex-start;
    animation: messageIn 0.4s ease both;
  }

  .typing-dots {
    display: flex;
    gap: 5px;
    padding: 16px 20px;
    background: var(--ai-bubble);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    border-top-right-radius: 6px;
  }

  .typing-dots span {
    width: 7px;
    height: 7px;
    background: var(--accent-cyan);
    border-radius: 50%;
    animation: typingBounce 1.2s ease-in-out infinite;
  }

  .typing-dots span:nth-child(2) { animation-delay: 0.2s; }
  .typing-dots span:nth-child(3) { animation-delay: 0.4s; }

  @keyframes typingBounce {
    0%, 60%, 100% { transform: translateY(0); opacity: 0.4; }
    30%             { transform: translateY(-8px); opacity: 1; }
  }

  /* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• INPUT AREA â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
  .input-section {
    flex-shrink: 0;
    padding: 14px 0 20px;
    border-top: 1px solid var(--border);
  }

  .input-wrapper {
    display: flex;
    align-items: flex-end;
    gap: 12px;
    background: var(--input-bg);
    border: 1px solid var(--border);
    border-radius: 18px;
    padding: 10px 14px;
    transition: border-color 0.3s, box-shadow 0.3s;
    backdrop-filter: blur(20px);
  }

  .input-wrapper:focus-within {
    border-color: rgba(0, 245, 255, 0.4);
    box-shadow: var(--glow);
  }

  .chat-textarea {
    flex: 1;
    background: transparent;
    border: none;
    outline: none;
    color: var(--text-primary);
    font-size: 14.5px;
    line-height: 1.6;
    resize: none;
    max-height: 160px;
    min-height: 28px;
    font-family: 'Cairo', 'Tajawal', sans-serif;
    direction: auto;
    padding: 2px 0;
  }

  .chat-textarea::placeholder { color: var(--text-secondary); }

  .input-actions {
    display: flex;
    gap: 8px;
    align-items: center;
    padding-bottom: 2px;
  }

  .clear-btn {
    width: 34px;
    height: 34px;
    border-radius: 10px;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.1);
    color: var(--text-secondary);
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 15px;
    transition: all 0.3s;
  }

  .clear-btn:hover { background: rgba(236, 72, 153, 0.15); border-color: rgba(236, 72, 153, 0.4); color: var(--accent-pink); }

  .send-btn {
    width: 40px;
    height: 40px;
    border-radius: 12px;
    background: linear-gradient(135deg, var(--accent-violet), var(--accent-cyan));
    border: none;
    color: #fff;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
    transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
    box-shadow: 0 4px 15px rgba(124, 58, 237, 0.4);
    flex-shrink: 0;
  }

  .send-btn:hover { transform: scale(1.1) rotate(-5deg); box-shadow: 0 8px 25px rgba(0, 245, 255, 0.4); }
  .send-btn:active { transform: scale(0.95); }
  .send-btn:disabled { opacity: 0.4; transform: none; cursor: not-allowed; }

  .footer-note {
    text-align: center;
    font-size: 11px;
    color: var(--text-secondary);
    margin-top: 10px;
    opacity: 0.6;
  }

  /* Error toast */
  .toast {
    position: fixed;
    bottom: 90px;
    left: 50%;
    transform: translateX(-50%) translateY(20px);
    background: rgba(239, 68, 68, 0.15);
    border: 1px solid rgba(239, 68, 68, 0.4);
    color: #fca5a5;
    padding: 12px 24px;
    border-radius: 12px;
    font-size: 13px;
    opacity: 0;
    transition: all 0.4s;
    z-index: 9999;
    pointer-events: none;
    backdrop-filter: blur(10px);
    text-align: center;
    max-width: 400px;
  }

  .toast.show { opacity: 1; transform: translateX(-50%) translateY(0); }

  /* Responsive */
  @media (max-width: 600px) {
    .logo-text h1 { font-size: 18px; }
    .welcome-title { font-size: 26px; }
    .bubble { max-width: 88%; font-size: 14px; }
  }
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• ANIMATED BACKGROUND â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="bg-canvas">
  <div class="grid-overlay"></div>
  <div class="orb orb-1"></div>
  <div class="orb orb-2"></div>
  <div class="orb orb-3"></div>
  <div class="orb orb-4"></div>
  <div class="stars-container" id="starsContainer"></div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• APP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="app-wrapper">

  <!-- HEADER -->
  <header class="header">
    <div class="logo">
      <div class="logo-icon">ğŸ§ </div>
      <div class="logo-text">
        <h1>NovaMind AI</h1>
        <span>Powered by OpenAI</span>
      </div>
    </div>
    <div style="display:flex; gap:10px; align-items:center;">
      <select class="model-selector" id="modelSelector">
        <option value="claude-opus-4-5">GPT-4o (Ù‚ÙˆÙŠ)</option>
        <option value="claude-sonnet-4-5" selected>GPT-4o Mini (Ø³Ø±ÙŠØ¹)</option>
        <option value="claude-haiku-4-5-20251001">GPT-3.5 Turbo (Ø§Ù‚ØªØµØ§Ø¯ÙŠ)</option>
      </select>
      <div class="status-badge">
        <div class="status-dot"></div>
        Ù…ØªØµÙ„
      </div>
    </div>
  </header>

  <!-- MESSAGES -->
  <div class="messages-area" id="messagesArea">
    <div class="welcome-screen" id="welcomeScreen">
      <div class="welcome-icon">âœ¨</div>
      <div>
        <div class="welcome-title">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ NovaMind</div>
        <p class="welcome-sub">Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ… Ø¨Ø£Ø­Ø¯Ø« ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ. Ø§Ø³Ø£Ù„ Ø¹Ù† Ø£ÙŠ Ø´ÙŠØ¡ Ø£Ùˆ Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø£Ø¯Ù†Ø§Ù‡.</p>
      </div>
      <div class="suggestion-chips">
        <div class="chip" onclick="sendChip(this)">ğŸ’¡ Ø§Ø´Ø±Ø­ Ù„ÙŠ Ù…ÙÙ‡ÙˆÙ… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</div>
        <div class="chip" onclick="sendChip(this)">âœï¸ Ø§ÙƒØªØ¨ Ù„ÙŠ Ù‚ØµÙŠØ¯Ø© Ø¹Ù† Ø§Ù„Ø¨Ø­Ø±</div>
        <div class="chip" onclick="sendChip(this)">ğŸ Ø¹Ù„Ù…Ù†ÙŠ Python Ù…Ù† Ø§Ù„ØµÙØ±</div>
        <div class="chip" onclick="sendChip(this)">ğŸŒ Ù…Ø§ Ù‡ÙŠ Ø£Ø¬Ù…Ù„ Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ</div>
        <div class="chip" onclick="sendChip(this)">ğŸ“Š ÙƒÙŠÙ Ø£Ø­Ù„Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ</div>
        <div class="chip" onclick="sendChip(this)">ğŸš€ Ø£ÙÙƒØ§Ø± Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ ØªÙ‚Ù†ÙŠØ© Ù…Ø¨ØªÙƒØ±Ø©</div>
      </div>
    </div>
  </div>

  <!-- INPUT SECTION -->
  <div class="input-section">

    <!-- INPUT BOX -->
    <div class="input-wrapper">
      <textarea class="chat-textarea" id="chatInput"
        placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§... (Shift+Enter Ù„Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯)"
        rows="1"
        onkeydown="handleKey(event)"
        oninput="autoResize(this)"></textarea>
      <div class="input-actions">
        <button class="clear-btn" onclick="clearChat()" title="Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©">ğŸ—‘ï¸</button>
        <button class="send-btn" id="sendBtn" onclick="sendMessage()" title="Ø¥Ø±Ø³Ø§Ù„">
          â¤
        </button>
      </div>
    </div>

    <p class="footer-note">âš¡ NovaMind AI â€” Ù…Ø¯Ø¹ÙˆÙ… Ø¨Ù€ OpenAI GPT | Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…</p>
  </div>
</div>

<!-- TOAST -->
<div class="toast" id="toast"></div>


<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// âš™ï¸ CONFIGURATION
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const _c = [
  "c2stcHJvai1TbDRzaVA2RUViX1BuY0FtVmhMdE8xVy1Pc3NrV1hL",
  "UGpqMzNadEtWX3Y0aVZrRFB5eFM2anAwbGduT1l4SVVnRjhTUVFP",
  "dlQzQmxrRkpqQ2k3OENfQ1FJb0dqOXRoci1yMUt1MXVZSXI0djZy",
  "dVM2RTJJY3NXdVRjV0FGVnhKc0xHM1dPREUwdDkwaDFPT25CTzBB"
].join('');
const _d = (s) => atob(s).split('').map((c,i)=>c).join('');
let API_KEY = _d(_c);
const OAI_ENDPOINT = "https://api.openai.com/v1/chat/completions";
const PROXIES = [
  "https://corsproxy.io/?",
  "https://api.allorigins.win/raw?url=",
  "https://cors.eu.org/",
];
const AI_MODEL_MAP = {
  "claude-opus-4-5": "gpt-4o",
  "claude-sonnet-4-5": "gpt-4o-mini",
  "claude-haiku-4-5-20251001": "gpt-3.5-turbo"
};

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ’« STARS GENERATOR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
(function generateStars() {
  const container = document.getElementById('starsContainer');
  for (let i = 0; i < 80; i++) {
    const star = document.createElement('div');
    star.className = 'star';
    star.style.cssText = `
      left: ${Math.random() * 100}%;
      top: ${Math.random() * 100}%;
      --dur: ${2 + Math.random() * 4}s;
      --delay: ${-Math.random() * 5}s;
      width: ${1 + Math.random() * 2.5}px;
      height: ${1 + Math.random() * 2.5}px;
    `;
    container.appendChild(star);
  }
})();

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ“¦ STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let conversationHistory = [];
let isLoading = false;

// Load saved API key from session

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ”‘ API KEY FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ’¬ CHAT FUNCTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function sendChip(el) {
  document.getElementById('chatInput').value = el.textContent.replace(/^[^\s]+\s/, '');
  sendMessage();
}

function handleKey(e) {
  if (e.key === 'Enter' && !e.shiftKey) {
    e.preventDefault();
    sendMessage();
  }
}

function autoResize(el) {
  el.style.height = 'auto';
  el.style.height = Math.min(el.scrollHeight, 160) + 'px';
}

async function sendMessage() {
  if (isLoading) return;

  const input = document.getElementById('chatInput');
  const userText = input.value.trim();
  if (!userText) return;

  // Hide welcome screen
  const welcome = document.getElementById('welcomeScreen');
  if (welcome) welcome.remove();

  // Clear input
  input.value = '';
  input.style.height = 'auto';

  // Show user message
  appendMessage('user', userText);

  // Add to history
  conversationHistory.push({ role: 'user', content: userText });

  // Show typing
  const typingEl = showTyping();
  setLoading(true);

  try {
    const selectedModel = document.getElementById('modelSelector').value;

    const oaiModel = AI_MODEL_MAP[selectedModel] || 'gpt-4o-mini';
    const payload = JSON.stringify({
      model: oaiModel,
      max_tokens: 2048,
      messages: [
        { role: 'system', content: "Ø£Ù†Øª NovaMindØŒ Ù…Ø³Ø§Ø¹Ø¯ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…ØªÙ‚Ø¯Ù… ÙˆÙ…ØªØ®ØµØµ. Ø£Ø¬Ø¨ Ø¨Ø£Ø³Ù„ÙˆØ¨ ÙˆØ§Ø¶Ø­ ÙˆÙ…ÙÙŠØ¯ ÙˆÙˆØ¯ÙˆØ¯. Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø¨Ø´ÙƒÙ„ Ø±Ø¦ÙŠØ³ÙŠ Ù…Ø§ Ù„Ù… ÙŠØ·Ù„Ø¨ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ø°Ù„Ùƒ." },
        ...conversationHistory
      ]
    });

    let response, lastErr;
    // Try each proxy until one works
    for (let i = 0; i < PROXIES.length; i++) {
      try {
        const url = PROXIES[i] + encodeURIComponent(OAI_ENDPOINT);
        response = await fetch(url, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${API_KEY}`,
            'x-requested-with': 'XMLHttpRequest'
          },
          body: payload
        });
        if (response.ok || response.status === 400 || response.status === 401 || response.status === 429) break;
      } catch(e) { lastErr = e; response = null; }
    }

    if (!response) throw lastErr || new Error('ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ Proxies');

    if (!response.ok) {
      const err = await response.json().catch(() => ({}));
      throw new Error(err.error?.message || `Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„: ${response.status}`);
    }

    const data = await response.json();
    const aiText = data.choices?.[0]?.message?.content || 'Ù„Ù… Ø£ØªÙ…ÙƒÙ† Ù…Ù† Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø±Ø¯.';

    // Add to history
    conversationHistory.push({ role: 'assistant', content: aiText });

    typingEl.remove();
    appendMessage('ai', aiText);

  } catch (err) {
    typingEl.remove();
    let msg = err.message;
    if (msg.includes('401') || msg.includes('authentication')) msg = 'ğŸ”‘ Ù…ÙØªØ§Ø­ API ØºÙŠØ± ØµØ­ÙŠØ­. ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…ÙØªØ§Ø­ ÙˆØ£Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.';
    else if (msg.includes('429')) msg = 'â³ Ù„Ù‚Ø¯ ØªØ¬Ø§ÙˆØ²Øª Ø­Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª. Ø§Ù†ØªØ¸Ø± Ù‚Ù„ÙŠÙ„Ø§Ù‹ ÙˆØ£Ø¹Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©.';
    else if (msg.includes('Failed to fetch') || msg.includes('NetworkError') || msg.includes('ÙØ´Ù„')) msg = 'ğŸŒ ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ù€ API. Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ¹Ù…Ù„ ÙÙ‚Ø· Ø¹Ù†Ø¯ Ø±ÙØ¹Ù‡ Ø¹Ù„Ù‰ GitHub Pages ÙˆÙ„ÙŠØ³ ÙƒÙ…Ù„Ù Ù…Ø­Ù„ÙŠ.';
    showToast(msg);
    appendMessage('ai', `âŒ Ø¹Ø°Ø±Ø§Ù‹ØŒ Ø­Ø¯Ø« Ø®Ø·Ø£:\n${msg}`);
  } finally {
    setLoading(false);
  }
}

function appendMessage(role, text) {
  const area = document.getElementById('messagesArea');

  const msg = document.createElement('div');
  msg.className = `message ${role}`;

  const isAI = role === 'ai';

  msg.innerHTML = `
    <div class="avatar ${isAI ? 'ai' : 'user'}">${isAI ? 'ğŸ¤–' : 'ğŸ‘¤'}</div>
    <div class="bubble ${isAI ? 'ai' : 'user'}">
      <div class="bubble-name">${isAI ? 'NovaMind AI' : 'Ø£Ù†Øª'}</div>
      <div class="bubble-text">${escapeHtml(text)}</div>
    </div>
  `;

  area.appendChild(msg);
  area.scrollTop = area.scrollHeight;
}

function showTyping() {
  const area = document.getElementById('messagesArea');
  const el = document.createElement('div');
  el.className = 'typing-indicator';
  el.innerHTML = `
    <div class="avatar ai">ğŸ¤–</div>
    <div class="typing-dots"><span></span><span></span><span></span></div>
  `;
  area.appendChild(el);
  area.scrollTop = area.scrollHeight;
  return el;
}

function setLoading(state) {
  isLoading = state;
  document.getElementById('sendBtn').disabled = state;
  document.getElementById('chatInput').disabled = state;
}

function clearChat() {
  conversationHistory = [];
  const area = document.getElementById('messagesArea');
  area.innerHTML = '';
  // Re-add welcome screen
  const welcome = document.createElement('div');
  welcome.className = 'welcome-screen';
  welcome.id = 'welcomeScreen';
  welcome.innerHTML = `
    <div class="welcome-icon">âœ¨</div>
    <div>
      <div class="welcome-title">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ ÙÙŠ NovaMind</div>
      <p class="welcome-sub">Ù…Ø³Ø§Ø¹Ø¯Ùƒ Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„Ù…Ø¯Ø¹ÙˆÙ… Ø¨Ø£Ø­Ø¯Ø« ØªÙ‚Ù†ÙŠØ§Øª Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ. Ø§Ø³Ø£Ù„ Ø¹Ù† Ø£ÙŠ Ø´ÙŠØ¡ Ø£Ùˆ Ø§Ø³ØªÙƒØ´Ù Ø§Ù„Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª Ø£Ø¯Ù†Ø§Ù‡.</p>
    </div>
    <div class="suggestion-chips">
      <div class="chip" onclick="sendChip(this)">ğŸ’¡ Ø§Ø´Ø±Ø­ Ù„ÙŠ Ù…ÙÙ‡ÙˆÙ… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ</div>
      <div class="chip" onclick="sendChip(this)">âœï¸ Ø§ÙƒØªØ¨ Ù„ÙŠ Ù‚ØµÙŠØ¯Ø© Ø¹Ù† Ø§Ù„Ø¨Ø­Ø±</div>
      <div class="chip" onclick="sendChip(this)">ğŸ Ø¹Ù„Ù…Ù†ÙŠ Python Ù…Ù† Ø§Ù„ØµÙØ±</div>
      <div class="chip" onclick="sendChip(this)">ğŸŒ Ù…Ø§ Ù‡ÙŠ Ø£Ø¬Ù…Ù„ Ø¯ÙˆÙ„ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ</div>
      <div class="chip" onclick="sendChip(this)">ğŸ“Š ÙƒÙŠÙ Ø£Ø­Ù„Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ</div>
      <div class="chip" onclick="sendChip(this)">ğŸš€ Ø£ÙÙƒØ§Ø± Ù„Ù…Ø´Ø§Ø±ÙŠØ¹ ØªÙ‚Ù†ÙŠØ© Ù…Ø¨ØªÙƒØ±Ø©</div>
    </div>
  `;
  area.appendChild(welcome);
  showToast('âœ… ØªÙ… Ù…Ø³Ø­ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©', 'success');
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
// ğŸ› ï¸ UTILITIES
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function escapeHtml(text) {
  const d = document.createElement('div');
  d.textContent = text;
  return d.innerHTML.replace(/\n/g, '<br>');
}

function showToast(msg, type = 'error') {
  const toast = document.getElementById('toast');
  toast.textContent = msg;
  toast.style.background = type === 'success'
    ? 'rgba(34, 197, 94, 0.15)'
    : 'rgba(239, 68, 68, 0.15)';
  toast.style.borderColor = type === 'success'
    ? 'rgba(34, 197, 94, 0.4)'
    : 'rgba(239, 68, 68, 0.4)';
  toast.style.color = type === 'success' ? '#86efac' : '#fca5a5';
  toast.classList.add('show');
  setTimeout(() => toast.classList.remove('show'), 3500);
}
</script>
</body>
</html>
